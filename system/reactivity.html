<!DOCTYPE html>
<html lang="en">

<head>
    <title>Listing Page</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <div id="app"></div>

    <template id="blog-post">
        <div id="content">
            @for{post, id in posts}
            <div class="post" data-v-for="post, id in posts">
                <h1 data-v-title data-on-click="edit(@{id})">@{post.title}</h1>
                <h3>By <span data-author>@{post.author}</span></h3>
                <p data-body>@{post.body}</p>
            </div>
            @end{}
            <form>
                <fieldset>
                    <legend>New Blog</legend>
                    <input data-title.bind/><br/> 
                    <input data-prop.="author"/><br/>
                    <textarea data-prop="title"></textarea>
                    <br/>
                    <input type="button" value="Submit" data-on-click="send"/><br/>
                </fieldset>
            </form>
        </div>
    </template>

    <script src="he.js"></script>
    <script src="templr.js"></script>
    <script>
        var allPosts = [
        {
            author: 'Brandon Smith',
            title: 'A CSS Trick',
            body: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.'
        },
        {
            author: 'Chris Coyier',
            title: 'Another CSS Trick',
            body: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.'
        },
        {
            author: 'Bob Saget',
            title: 'A Home Video',
            body: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.'
        }
        ]

        ;
        (function(dom, template, model) {
            var markup = document.querySelector(template);
            var expanded = Tmpl.splitExpand(he.decode(markup.innerHTML))(model).reduce(function(acc, curr) {
                return acc.concat(curr.value || "");
            }, "");
            console.log(expanded);

            //render content
            var range = document.createRange();
            var target = document.querySelector(dom);
            //make 'target' the context node
            range.selectNode(target);
            //create node from text
            var frag = range.createContextualFragment(expanded);
            //replace target
            target.parentNode.replaceChild(frag, target);
        })("#app", "#blog-post", {posts: allPosts});
    </script>
</body>

</html>